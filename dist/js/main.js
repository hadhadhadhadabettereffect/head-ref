Detector.webgl||Detector.addGetWebGLMessage();var camera,controls,scene,renderer,container,offset,intersection,raycaster,mouse,plane,lamp,orb,W_HEIGHT=window.innerHeight,W_WIDTH=window.innerWidth,selected=null,hovered=null,dragTargets=[];function initLights(){var e=new THREE.PointLight(16777215,1,100);scene.add(new THREE.AmbientLight(2236962)),(lamp=new THREE.Object3D).position.set(3,3,3),lamp.add(e),orb=new THREE.Mesh(new THREE.SphereGeometry(.25,16,8),new THREE.MeshBasicMaterial({color:16755234})),lamp.add(orb),scene.add(lamp),dragTargets.push(orb)}var presets=[[0,0,9.5,0,7.5,9.5],[8.9,-.5,-2.6,0,7.5,9.5],[3.75,-.4,5,0,7.5,9.5]];function handlePresetClick(e){if("preset"==e.target.className){var n=presets[e.target.getAttribute("data-preset")];controls.reset(),camera.position.set(n[0],n[1],n[2]),lamp.position.set(n[3],n[4],n[5])}}function init(){scene=new THREE.Scene,renderer=new THREE.WebGLRenderer,W_HEIGHT=window.innerHeight,W_WIDTH=window.innerWidth,renderer.setSize(W_WIDTH,W_HEIGHT),container=renderer.domElement,(camera=new THREE.PerspectiveCamera(75,W_WIDTH/W_HEIGHT,.1,1e3)).position.z=10,(controls=new THREE.OrbitControls(camera,container)).enableDamping=!0,controls.dampingFactor=.25,controls.maxDistance=30,controls.minDistance=2,controls.rotateSpeed=.125,controls.panSpeed=.125,raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,plane=new THREE.Plane,offset=new THREE.Vector3,intersection=new THREE.Vector3,initLights(),requestAnimationFrame(animate),document.body.appendChild(container),(new THREE.OBJLoader).load("dist/models/planes.obj",function(e){return scene.add(e)}),window.addEventListener("resize",onWindowResize,!1),window.addEventListener("mousemove",onMouseMove,!1),container.addEventListener("mousedown",onMouseDown,!1),container.addEventListener("mouseup",onMouseUp,!1)}function animate(){requestAnimationFrame(animate),render()}function render(){if(controls.update(),raycaster.setFromCamera(mouse,camera),selected)container.style.cursor="move";else{var e=raycaster.intersectObjects(dragTargets);0<e.length?hovered!=e[0]&&(hovered=e[0].object,plane.setFromNormalAndCoplanarPoint(camera.getWorldDirection(plane.normal),lamp.position),hovered.material.color.set(16768290),container.style.cursor="pointer",controls.enabled=!1):null!==hovered&&(hovered=null,container.style.cursor="default",controls.enabled=!0,orb.material.color.set(16755234))}renderer.render(scene,camera)}function onMouseMove(e){mouse.x=e.clientX/W_WIDTH*2-1,mouse.y=-e.clientY/W_HEIGHT*2+1,selected&&raycaster.ray.intersectPlane(plane,intersection)&&lamp.position.copy(intersection.sub(offset))}function onMouseDown(e){null!==(selected=hovered)&&raycaster.ray.intersectPlane(plane,intersection)&&offset.copy(intersection).sub(lamp.position)}function onMouseUp(){selected=null}function onWindowResize(){W_HEIGHT=window.innerHeight,W_WIDTH=window.innerWidth,camera.aspect=W_WIDTH/W_HEIGHT,camera.updateProjectionMatrix(),renderer.setSize(W_WIDTH,W_HEIGHT)}document.getElementById("presets").addEventListener("click",handlePresetClick,!1),init();